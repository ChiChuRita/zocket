---
title: Procedures
description: Defining inputs, handlers, and validation
icon: lucide:function-square
---

Procedures (or Messages) are the individual endpoints of your Zocket application.

## Anatomy of a Procedure

A procedure consists of three parts:
1.  **Input Validation** (Optional)
2.  **Middleware** (Optional)
3.  **Handler** (Required)

```typescript
const sendMessage = zo.message
  .input(z.object({ text: z.string() })) // 1. Input
  .use(authMiddleware)                   // 2. Middleware
  .handle(({ ctx, input }) => {          // 3. Handler
    console.log(input.text);
  });
```

## Input Validation

Zocket uses your schema validation library (Zod, Valibot, etc.) to validate incoming data.

```typescript
.input(
  z.object({
    title: z.string().min(1),
    tags: z.array(z.string()).max(5).optional()
  })
)
```

If the input is invalid, Zocket will throw a validation error and the handler will **not** be executed. The client will receive the error.

## The Handler

The `.handle()` method is where your business logic lives. It receives an object with:
- `ctx`: The context object for the current connection.
- `input`: The validated input data.

```typescript
.handle(async ({ ctx, input }) => {
  // Database operations
  const post = await db.post.create({
    data: { title: input.title, authorId: ctx.user.id }
  });

  // Return values (RPC style)
  return post;
})
```

## Async Handlers

Handlers can be asynchronous. If you return a value (or a Promise that resolves to a value), the client can `await` the call to receive that value.

```typescript
// Server
.handle(async () => {
  return "success";
})

// Client
const result = await client.example.myProcedure({}); // result === "success"
```
