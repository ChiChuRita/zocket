---
title: Authentication
description: Secure your WebSocket connections
icon: lucide:lock
---

Authentication in WebSockets usually happens during the initial connection handshake. Since standard WebSocket APIs in browsers don't support custom headers, Zocket (and many other libs) sends "headers" as URL query parameters.

### Server Side

Zocket validates your `headers` schema **before** upgrading the connection. Use it to require the presence/shape of auth parameters.

Then, use `onConnect` to verify tokens and build per-connection context.

```typescript
const zo = zocket.create({
  headers: z.object({
    token: z.string(),
  }),
  onConnect: async (headers) => {
    const user = await verifyToken(headers.token);
    
    if (!user) {
      // Recommended (current behavior): mark the connection as unauthenticated
      // and gate protected procedures with middleware.
      return { user: null };
    }

    // Return the user to set it as the context
    return { user };
  },
});
```

### Client Side

Pass headers in the `createZocketClient` options.

```typescript
const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  headers: {
    token: "user-session-token",
  },
});
```
