---
title: Adapters
description: Learn how to use Zocket with different runtimes and servers.
---

# Server Adapters

Zocket provides adapters for different JavaScript runtimes. Currently, Bun has first-class support.

## Bun Adapter

The recommended way to use Zocket is with Bun:

```typescript
import { createBunServer } from "@zocket/core";
import { appRouter, zo } from "./router";

const handlers = createBunServer(appRouter, zo);

const server = Bun.serve({
  fetch: handlers.fetch,
  websocket: handlers.websocket,
  port: 3000,
  hostname: "127.0.0.1",
});

console.log(`Server running on ws://localhost:${server.port}`);
```

## Complete Bun Example

```typescript
import { z } from "zod";
import { zocket, createBunServer } from "@zocket/core";

const zo = zocket.create({
  headers: z.object({
    authorization: z.string(),
  }),
  onConnect: async (headers, clientId) => {
    const user = await validateAuth(headers.authorization);
    return {
      userId: user.id,
      username: user.name,
    };
  },
});

const router = {
  chat: {
    message: zo.message.incoming({
      payload: z.object({ text: z.string() }),
    }),
    onMessage: zo.message.outgoing({
      payload: z.object({ user: z.string(), text: z.string() }),
    }),
  },
};

const appRouter = zo.router(router, {
  chat: {
    message: ({ payload, ctx }) => {
      ctx.send.chat
        .onMessage({
          user: ctx.username,
          text: payload.text,
        })
        .broadcast();
    },
  },
});

const handlers = createBunServer(appRouter, zo);

Bun.serve({
  fetch: handlers.fetch,
  websocket: handlers.websocket,
  port: 3000,
});
```

## Configuration Options

### Port and Hostname

```typescript
Bun.serve({
  fetch: handlers.fetch,
  websocket: handlers.websocket,
  port: 3000, // Port number
  hostname: "0.0.0.0", // Listen on all interfaces
});
```

### Development vs Production

```typescript
const isDev = process.env.NODE_ENV !== "production";

Bun.serve({
  fetch: handlers.fetch,
  websocket: handlers.websocket,
  port: isDev ? 3000 : 8080,
  hostname: isDev ? "127.0.0.1" : "0.0.0.0",
});
```

## Handler Interface

The `createBunServer` function returns:

```typescript
{
  fetch: (req, server) => Response | undefined,
  websocket: WebSocketHandler,
  publish: (topic, message) => void,
}
```

These integrate directly with `Bun.serve()`.

## HTTPS Support

For HTTPS in production:

```typescript
Bun.serve({
  fetch: handlers.fetch,
  websocket: handlers.websocket,
  port: 443,
  hostname: "0.0.0.0",
  tls: {
    key: Bun.file("./key.pem"),
    cert: Bun.file("./cert.pem"),
  },
});
```

## Generic Adapter (Coming Soon)

For Node.js and other runtimes:

```typescript
import { createServer } from "@zocket/core";
import { nodeAdapter } from "@zocket/core/adapters/node";

const server = createServer(appRouter, zo, nodeAdapter, {
  port: 3000,
  hostname: "127.0.0.1",
});
```

Note: Node.js adapter is in development.

## Custom Adapter

You can create custom adapters by implementing the `ServerAdapter` interface:

```typescript
import type { ServerAdapter } from "@zocket/core";

const myAdapter: ServerAdapter = {
  start: (options) => {
    // Implement your adapter logic
    return {
      port: 3000,
      stop: (force) => {
        /* cleanup */
      },
      publish: (topic, message) => {
        /* publish */
      },
    };
  },
};
```

## Next Steps

- [Understand lifecycle hooks](/server/lifecycle)
- [Learn about sending messages](/server/sending-messages)
- [Deploy your server](/advanced/best-practices)
