---
title: Creating Client
description: Learn how to create and configure a Zocket client.
---

# Creating a Zocket Client

The `createZocketClient` function creates a type-safe WebSocket client that connects to your Zocket server.

## Basic Client

```typescript
import { createZocketClient } from "@zocket/core";
import type { AppRouter } from "./server";

const client = createZocketClient<AppRouter>("ws://localhost:3000");
```

## With Options

```typescript
const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  headers: { authorization: "Bearer token123" },
  maxReconnectionDelay: 10000,
  minReconnectionDelay: 1000,
  reconnectionDelayGrowFactor: 1.3,
  maxRetries: Infinity,
  debug: true,
  onOpen: () => console.log("Connected!"),
  onClose: () => console.log("Disconnected"),
});
```

## Configuration Options

### URL

The WebSocket URL to connect to:

```typescript
// Local development
const client = createZocketClient<AppRouter>("ws://localhost:3000");

// Production
const client = createZocketClient<AppRouter>("wss://api.example.com");

// With path
const client = createZocketClient<AppRouter>("wss://api.example.com/ws");
```

### Headers

Pass headers for authentication or configuration:

```typescript
const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  headers: {
    authorization: "Bearer token123",
    "api-key": "key123",
    "client-version": "1.0.0",
  },
});
```

Headers are sent as query parameters in the upgrade request.

### Reconnection

Configure automatic reconnection behavior:

```typescript
const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  // Maximum delay between reconnection attempts (ms)
  maxReconnectionDelay: 10000,

  // Minimum delay between reconnection attempts (ms)
  minReconnectionDelay: 1000,

  // Growth factor for exponential backoff
  reconnectionDelayGrowFactor: 1.3,

  // Maximum reconnection attempts (Infinity = never give up)
  maxRetries: Infinity,
});
```

### Debug Mode

Enable debug logging:

```typescript
const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  debug: true,
});

// Logs:
// CLIENT: Connected
// CLIENT: Sent: {"type":"chat.message","payload":{...}}
// CLIENT: Received: {"type":"chat.onMessage","payload":{...}}
```

### Lifecycle Callbacks

```typescript
const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  onOpen: () => {
    console.log("✅ Connected to server");
    // Initialize app state
  },
  onClose: () => {
    console.log("❌ Disconnected from server");
    // Clean up or show offline UI
  },
});
```

## Complete Example

```typescript
import { createZocketClient } from "@zocket/core";
import type { AppRouter } from "./server";

const token = localStorage.getItem("auth_token");

const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  headers: {
    authorization: `Bearer ${token}`,
    "user-agent": navigator.userAgent,
  },
  maxReconnectionDelay: 10000,
  minReconnectionDelay: 1000,
  reconnectionDelayGrowFactor: 1.3,
  maxRetries: 10, // Give up after 10 attempts
  debug: process.env.NODE_ENV === "development",

  onOpen: () => {
    console.log("Connected!");
    document.querySelector("#status").textContent = "Online";
  },

  onClose: () => {
    console.log("Disconnected");
    document.querySelector("#status").textContent = "Offline";
  },
});

export default client;
```

## Type Safety

The client is fully typed based on your router:

```typescript
// Server router
const router = {
  chat: {
    message: zo.message.incoming({
      payload: z.object({ text: z.string() }),
    }),
    onMessage: zo.message.outgoing({
      payload: z.object({ user: z.string(), text: z.string() }),
    }),
  },
};

export type AppRouter = typeof router;

// Client automatically knows the types!
const client = createZocketClient<AppRouter>("ws://localhost:3000");

// Full autocomplete and type checking
client.send.chat.message({ text: "Hello" }); // ✅
client.on.chat.onMessage((data) => {
  data.user; // string
  data.text; // string
});
```

## Client Properties

### readyState

Check connection state:

```typescript
console.log(client.readyState);
// 0 = CONNECTING
// 1 = OPEN
// 2 = CLOSING
// 3 = CLOSED
```

### Connection Methods

```typescript
// Manually reconnect
client.reconnect();

// Close connection
client.close();
```

## Environment-Specific Configuration

### Development

```typescript
const isDev = import.meta.env.DEV;

const client = createZocketClient<AppRouter>(
  isDev ? "ws://localhost:3000" : "wss://api.prod.com",
  {
    debug: isDev,
    maxRetries: isDev ? Infinity : 10,
  }
);
```

### Browser

```typescript
const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  headers: {
    "user-agent": navigator.userAgent,
    "screen-size": `${window.innerWidth}x${window.innerHeight}`,
  },
});
```

### React Native

```typescript
import { createZocketClient } from "@zocket/core";

// Ensure WebSocket is available
if (!global.WebSocket) {
  global.WebSocket = require("react-native-websocket");
}

const client = createZocketClient<AppRouter>("ws://localhost:3000");
```

## Best Practices

### 1. Reuse Client Instance

```typescript
// ✅ Good: Single client instance
// client.ts
export const client = createZocketClient<AppRouter>("ws://localhost:3000");

// other files
import { client } from "./client";

// ❌ Bad: Multiple instances
function MyComponent() {
  const client = createZocketClient<AppRouter>("ws://localhost:3000");
}
```

### 2. Handle Connection State

```typescript
const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  onOpen: () => {
    console.log("Connected");
    showOnlineUI();
  },
  onClose: () => {
    console.log("Disconnected");
    showOfflineUI();
  },
});
```

### 3. Secure Credentials

```typescript
// ✅ Good: Secure token handling
const token = await getSecureToken();
const client = createZocketClient<AppRouter>("wss://api.example.com", {
  headers: { authorization: `Bearer ${token}` },
});

// ❌ Bad: Hardcoded credentials
const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  headers: { authorization: "Bearer hardcoded_token" },
});
```

### 4. Clean Up

```typescript
// Close connection when done
window.addEventListener("beforeunload", () => {
  client.close();
});
```

## Next Steps

- [Learn to send messages](/client/sending-messages)
- [Handle incoming messages](/client/receiving-messages)
- [Manage connections](/client/connection-management)
