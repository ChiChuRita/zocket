---
title: Sending Messages
description: Learn how to send messages from the client to the server.
---

# Sending Messages

Use `client.send` to send type-safe messages to the server.

## Basic Sending

```typescript
client.send.chat.message({ text: "Hello!" });
```

## Type Safety

The client knows exactly what messages are available and what data they expect:

```typescript
// Server defines
const router = {
  chat: {
    message: zo.message.incoming({
      payload: z.object({
        text: z.string(),
        priority: z.number(),
      }),
    }),
  },
};

// Client has full type safety
client.send.chat.message({
  text: "Hello",
  priority: 1,
}); // ✅ Correct

client.send.chat.message({
  text: "Hello",
  priority: "high", // ❌ Type error
});

client.send.chat.typo({ text: "Hi" }); // ❌ Type error
```

## Complete Example

```typescript
import { createZocketClient } from "@zocket/core";
import type { AppRouter } from "./server";

const client = createZocketClient<AppRouter>("ws://localhost:3000", {
  headers: { username: "Alice" },
});

// Wait for connection
client.onOpen(() => {
  // Send simple message
  client.send.chat.message({ text: "Hello everyone!" });

  // Send with all fields
  client.send.user.update({
    name: "Alice Smith",
    email: "alice@example.com",
    age: 30,
  });

  // Send to join a room
  client.send.rooms.join({ roomId: "general" });
});
```

## Sending Patterns

### Send on Event

```typescript
button.addEventListener("click", () => {
  client.send.chat.message({ text: input.value });
});
```

### Send Periodically

```typescript
setInterval(() => {
  client.send.game.heartbeat({});
}, 5000);
```

### Send with User Input

```typescript
form.addEventListener("submit", (e) => {
  e.preventDefault();

  const formData = new FormData(e.target);

  client.send.user.create({
    name: formData.get("name"),
    email: formData.get("email"),
  });
});
```

### Conditional Sending

```typescript
if (user.isAuthenticated) {
  client.send.auth.verifySession({ token: user.token });
} else {
  client.send.auth.login({ username, password });
}
```

## Best Practices

### 1. Wait for Connection

```typescript
// ✅ Good: Wait for connection
client.onOpen(() => {
  client.send.chat.message({ text: "Hello!" });
});

// ❌ Bad: Send immediately (might not be connected)
client.send.chat.message({ text: "Hello!" });
```

### 2. Handle Connection State

```typescript
const sendMessage = (text: string) => {
  if (client.readyState === 1) {
    // OPEN
    client.send.chat.message({ text });
  } else {
    console.log("Not connected, queueing message");
    messageQueue.push(text);
  }
};

client.onOpen(() => {
  // Send queued messages
  messageQueue.forEach((text) => {
    client.send.chat.message({ text });
  });
  messageQueue = [];
});
```

### 3. Validate Before Sending

```typescript
const sendMessage = (text: string) => {
  if (!text.trim()) {
    console.error("Message cannot be empty");
    return;
  }

  if (text.length > 500) {
    console.error("Message too long");
    return;
  }

  client.send.chat.message({ text });
};
```

### 4. Rate Limiting

```typescript
let lastSent = 0;
const RATE_LIMIT = 1000; // 1 message per second

const sendMessage = (text: string) => {
  const now = Date.now();

  if (now - lastSent < RATE_LIMIT) {
    console.error("Sending too fast");
    return;
  }

  lastSent = now;
  client.send.chat.message({ text });
};
```

## Next Steps

- [Receive messages](/client/receiving-messages)
- [Manage connections](/client/connection-management)
- [Pass headers](/client/headers)
