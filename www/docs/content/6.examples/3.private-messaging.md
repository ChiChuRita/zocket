---
title: Private Messaging
description: Implement direct client-to-client private messaging.
---

# Private Messaging Example

Send private messages directly between clients using client IDs.

## Implementation

Based on `packages/core/test/fluent-api.test.ts`, here's how to implement private messaging:

```typescript
const router = {
  chat: {
    private: zo.message.incoming({
      payload: z.object({
        targetUserId: z.string(),
        message: z.string(),
      }),
    }),
    onPrivate: zo.message.outgoing({
      payload: z.object({
        from: z.string(),
        message: z.string(),
        timestamp: z.date(),
      }),
    }),
  },
  connection: {
    getClientId: zo.message.incoming({
      payload: z.object({}),
    }),
    onClientId: zo.message.outgoing({
      payload: z.object({ clientId: z.string() }),
    }),
  },
};

const appRouter = zo.router(router, {
  chat: {
    private: ({ payload, ctx }) => {
      ctx.send.chat
        .onPrivate({
          from: ctx.userName,
          message: payload.message,
          timestamp: new Date(),
        })
        .to([payload.targetUserId]);
    },
  },
  connection: {
    getClientId: ({ ctx }) => {
      ctx.send.connection
        .onClientId({
          clientId: ctx.clientId,
        })
        .to([ctx.clientId]);
    },
  },
});
```

## Client Usage

```typescript
// Get own client ID
client.on.connection.onClientId((data) => {
  console.log("My client ID:", data.clientId);
  myClientId = data.clientId;
});

client.onOpen(() => {
  client.send.connection.getClientId({});
});

// Listen for private messages
client.on.chat.onPrivate((data) => {
  console.log(`Private from ${data.from}: ${data.message}`);
});

// Send private message
const sendPrivateMessage = (targetId: string, message: string) => {
  client.send.chat.private({
    targetUserId: targetId,
    message,
  });
};
```

## Features

- **Direct Messaging**: Send to specific client IDs
- **Client Discovery**: Get your own client ID
- **Type-Safe**: Full type checking for messages
- **Timestamped**: Messages include timestamps
