---
title: Router Types
description: TypeScript types for routers and messages.
---

# Router Types

Type definitions for Zocket routers and messages.

## AnyRouter

Type for any valid router:

```typescript
type AnyRouter = {
  [key: string]: AnyMessage | AnyRouter;
};
```

## IncomingMessage

Type for incoming messages (client → server):

```typescript
type IncomingMessage<TDef extends MessageDef, TCtxExt = {}> = TDef & {
  _direction: "in";
  _middlewares?: ReadonlyArray<MiddlewareFn<any, any, any>>;
  _ctx?: TCtxExt;
};
```

## OutgoingMessage

Type for outgoing messages (server → client):

```typescript
type OutgoingMessage<TDef extends MessageDef> = TDef & {
  _direction: "out";
};
```

## MessageDef

Base type for message definitions:

```typescript
type MessageDef = {
  payload: StandardSchemaV1;
};
```

## Handlers

Type for message handlers:

```typescript
type Handlers<TRouter extends AnyRouter, TUserContext> = {
  [K in keyof TRouter]: TRouter[K] extends IncomingMessage<
    infer TDef,
    infer TCtxExt
  >
    ? HandlerFn<TDef, TCtxExt, TUserContext>
    : TRouter[K] extends AnyRouter
    ? Handlers<TRouter[K], TUserContext>
    : never;
};
```

## ZocketContext

Type for handler context:

```typescript
type ZocketContext<TUserContext, TRouter extends AnyRouter> = TUserContext & {
  send: Sender<TRouter>;
  rooms: RoomOperations;
  clientId: string;
};
```

## Sender

Type for sending messages:

```typescript
type Sender<TRouter extends AnyRouter> = {
  [K in keyof TRouter]: TRouter[K] extends OutgoingMessage<infer TDef>
    ? (payload: StandardSchemaV1.InferOutput<TDef["payload"]>) => FluentSender
    : TRouter[K] extends AnyRouter
    ? Sender<TRouter[K]>
    : never;
};
```

## FluentSender

Type for fluent sending API:

```typescript
type FluentSender = {
  to: (clientIds: string[]) => void;
  toRoom: (roomIds: string[]) => void;
  broadcast: () => void;
};
```

## RoomOperations

Type for room operations:

```typescript
type RoomOperations = {
  join: (roomId: string) => void;
  leave: (roomId: string) => void;
  broadcast: (roomId: string, route: string, payload: unknown) => void;
  current: ReadonlySet<string>;
  has: (roomId: string) => boolean;
};
```

## DisconnectContext

Type for onDisconnect context:

```typescript
type DisconnectContext<TUserContext> = TUserContext & {
  clientId: string;
  rooms: ReadonlySet<string>;
};
```

## Usage Example

```typescript
import type { AnyRouter, ZocketContext } from "@zocket/core";

function logContext<TRouter extends AnyRouter>(
  ctx: ZocketContext<any, TRouter>
) {
  console.log(ctx.clientId);
  console.log([...ctx.rooms.current]);
}
```
